const titleInput=document.getElementById("post-title"),contentInput=document.getElementById("post-content"),saveButton=document.getElementById("saveChanges");function checkChanges(){return""!=titleInput.value&&""!=contentInput.value&&(titleInput.value!=titleInput.getAttribute("data-value")||contentInput.value!=contentInput.getAttribute("data-value"))}function getChanges(){const t=[];return titleInput.value!=titleInput.getAttribute("data-value")&&t.push({name:"title",value:titleInput.value}),contentInput.value!=contentInput.getAttribute("data-value")&&t.push({name:"content",value:contentInput.value}),t}function showUnsavedChanges(){document.getElementById("unsavedChanges").style.display="block"}function hideUnsavedChanges(){document.getElementById("unsavedChanges").style.display="none"}function onAnyInput(t){t.preventDefault(),checkChanges()?showUnsavedChanges():hideUnsavedChanges()}function saveChanges(){getChanges().forEach((async t=>{const e=await fetch(`/api/posts/${postId}/${t.name}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`${document.cookie.split("token=")[1].split(";")[0]}`},body:JSON.stringify({[t.name]:t.value})}),n=await e.json();if(console.log(n),n.succes)if("title"==t.name){titleInput.setAttribute("data-value",titleInput.value);const t=n.post.postId;window.location.href=`/posts/${t}/edit`}else"content"==t.name&&contentInput.setAttribute("data-value",contentInput.value);else console.log("Failed to save changes of "+t.name),alert("Failed to save changes of "+t.name)})),hideUnsavedChanges()}titleInput.addEventListener("input",onAnyInput),contentInput.addEventListener("input",onAnyInput),saveButton.addEventListener("click",saveChanges);